{% extends 'main.html' %}

{% block content %}
<div class="dropdown mb-2">
    <button class="btn btn-secondary dropdown-toggle btn-dark" type="button" data-bs-toggle="dropdown" aria-expanded="false">
        Фильтрация
    </button>
    <form action="" method="get" class="dropdown-menu bg-dark" >
        <p class="text-white mx-3 mt-3">Сортировать по</p>
        <div class="form-check text-white mx-3">
            <input type="radio" class="form-check-input" name="sort" id="flexRadioDefault2" value="asc" {% if sort_order == 'asc' %}checked{% endif %} onchange="this.form.submit()">
            <label for="flexRadioDefault2" class="form-check-label">
                Увеличение цены
            </label>
        </div>
        <div class="form-check text-white mx-3">
            <input type="radio" class="form-check-input" name="sort" id="flexRadioDefault3" value="desc" {% if sort_order == "desc" %}checked{% endif %} onchange="this.form.submit()">
            <label for="flexRadioDefault3" class="form-check-label">
                Уменьшение цены
            </label>
        </div>
    </form>
</div>
<div class="album py-5 bg-light">
    <div class="container">
        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
            {% for product in products %}
            <div class="col">
                <div class="card shadow-sm">
                    <div class="col-14">
                        <img src="{{ product.thumbnail.url }}" class="bd-placeholder-img card-img-top" alt="{{ product.title }}">
                    </div>
                    <div class="col-14">
                        <div class="card-body">
                            <h4 class="card-title pricing-card-title">{{ product.price }}₽</h4>
                            <h5 class="card-title"><a href="{% url 'products_detail' product.id %}">{{ product.title }}</a></h5>
                            <p class="card-text">{{ product.time_create }}</p>
                            <div class="d-flex justify-content-between align-items-center">
                                {% if product.id|stringformat:"s" in request.session.cart %}
                                    <form action="{% url 'remove_from_cart' product.id %}" method="post">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-outline-danger">Удалить</button>
                                    </form>
                                {% else %}
                                    <form action="{% url 'add_to_cart' product.id %}" method="post">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-outline-warning">В корзину</button>
                                    </form>
                                {% endif %}
                            </div>
                            <hr>
                            Категория: <a href="{% url 'products_by_category' product.category.id %}">{{ product.category.title }}</a>
                            / Выставил: {{ product.seller.username }}
                          </div>
                        </div>
                    </div>
              </div>
            {% endfor %}
        </div>
    </div>
</div>
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Форма обратной связи</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
        <form action="" method="post">
      <div class="modal-body">
          {% csrf_token %}
          {{ form.as_p }}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отмена</button>
        <button type="submit" class="btn btn-primary">Отправить</button>
      </div>
        </form>
    </div>
  </div>
</div>
{% endblock %}
